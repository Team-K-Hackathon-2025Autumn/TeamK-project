{% extends 'base.html' %} {% block title %} {{ group.name }} {% endblock %} {%
block body %}
<header>
  <div class="main-container">
    <div class="logo">
      <img id="logo_img" src="../static/img/cookchat_logo.png" alt="cookchat">
    </div>
    <li class="logout-icon">
      <a href="{{ url_for('logout_process') }}">
        <span class="icon"><ion-icon name="log-out-outline"></ion-icon></span>
      </a>
    </li>
  </div>
</header>
<div class="chat-header">
  <div id="chat-header-left">
    <a href="{{ url_for('home_view') }}">
      <button><ion-icon name="chevron-back-outline"></ion-icon></button>
    </a>
    <p id="group-name">{{ group.name }}</p>
  </div>
  <div id="chat-header-right">
    {% if uid == group.created_by %}
    <button id="group-update-button">
      <ion-icon name="pencil-outline"></ion-icon>
    </button>
    {% include 'modal/update-group.html' %}
    <button id="member-add-button">
      <ion-icon name="person-add-outline"></ion-icon>
    </button>
    {% include 'modal/add-member.html' %}{% endif %}
    <button id="member-view-button">
      <ion-icon name="people-outline"></ion-icon>
    </button>
    {% include 'modal/view-member.html' %}
  </div>
</div>

<div id="message-area">
  {% if messages|length > 0 %} {% for message in messages %} {% if message.uid
  == uid %}
  <!-- 自分のメッセージ -->
  <div class="my-messages">
    <div class="my-message-top">
      <form action="/group/{{ group.id }}/message/delete" method="POST">
        <button
          class="delete-message-button"
          name="message_id"
          value="{{ message.id }}"
        >
          <ion-icon name="trash-outline"></ion-icon>
        </button>
      </form>
    </div>
    <div class="my-message-content">
      <p class="my-sendTime">{{ message.created_at }}</p>
      <p class="box box-right">{{ message.message }}</p>
    </div>
    <div class="my-message-bottom">
      <form
        class="reaction-form"
        action="/group/{{ group.id }}/message/reaction"
        method="POST"
      >
        <input type="hidden" name="message_id" value="{{message.id}}" />
        <input
          type="hidden"
          name="message_creation_type"
          value="{{ message.creation_type }}"
        />
        <button class="reaction-message-button">
          食べたｲｲﾈ! <span class="reaction-counts">{{ message.counts }}</span>
        </button>
      </form>
    </div>
  </div>
  {% else %}
  <!-- 自分以外のメッセージ -->
  <div class="other-messages">
    <div class="other-message-top">
      <p class="user-name">{{ message.name }}</p>
    </div>
    <div class="other-message-content">
      <p class="box box-left">{{ message.message }}</p>
      <p class="other-sendTime">{{ message.created_at }}</p>
    </div>
    <div class="other-message-bottom">
      <form
        class="reaction-form"
        action="/group/{{ group.id }}/message/reaction"
        method="POST"
      >
        <input type="hidden" name="message_id" value="{{message.id}}" />
        <input
          type="hidden"
          name="message_creation_type"
          value="{{ message.creation_type }}"
        />
        <button class="reaction-message-button">
          食べたｲｲﾈ! <span class="reaction-counts">{{ message.counts }}</span>
        </button>
      </form>
    </div>
  </div>
  {% endif %} {% endfor %} {% else %}
  <p id="no-message">まだメッセージがありません</p>
  {% endif %}
</div>

<div class="typing-box-wrapper">
  <form
    class="typing-box"
    action="/group/{{ group.id }}/message"
    method="POST"
    name="newMessageForm"
  >
    <textarea name="message" id="message" autofocus required></textarea>
    <input type="hidden" name="gid" value="{{ group.id }}" />
    <button type="submit" id="add-message-button">
      <ion-icon name="paper-plane"></ion-icon>
    </button>
  </form>
  <a id="create-menu" href="#">
    <img src="{{ url_for('static', filename='img/button.svg') }}" />
  </a>
  {% include 'modal/input-ingredients.html' %}
</div>

{% endblock %} {% block script %}
<script type="text/javascript">
  // prettier-ignore
  const uid = JSON.parse('{{ uid|tojson }}');
  const group = JSON.parse('{{ group|tojson }}');
</script>
<script
  src="{{url_for('static',filename='js/scroll-message.js')}}"
  type="text/javascript"
></script>
<script
  src="{{url_for('static',filename='js/time-reaction.js')}}"
  type="text/javascript"
></script>
<script
  src="{{url_for('static',filename='js/groups/update-group.js')}}"
  type="text/javascript"
></script>
<script
  src="{{url_for('static',filename='js/members/view-member.js')}}"
  type="text/javascript"
></script>
<script
  src="{{url_for('static',filename='js/members/add-member.js')}}"
  type="text/javascript"
></script>
<script
  src="{{url_for('static',filename='js/ingredients/input-ingredients.js')}}"
  type="text/javascript"
></script>
{% endblock %}
